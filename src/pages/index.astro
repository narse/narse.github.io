---
import FooterBlogRow from "@components/home/FooterBlogRow.astro";
import Pagination from "@components/blog/Pagination.astro";
import { getCollection } from "astro:content";
import BlogLayout from "@layouts/BlogLayout.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "@/constants";

const allPosts = await getCollection("posts");

// Sort all posts by date
const sortedPosts = allPosts.sort(
  (a, b) => b.data.publishedAt.getTime() - a.data.publishedAt.getTime()
);

// Homepage shows first 9 posts in FooterBlogRow (3x3 grid)
const postsPerPage = 9;
const totalPages = Math.ceil(sortedPosts.length / postsPerPage);
---

<BlogLayout title={SITE_TITLE} description={SITE_DESCRIPTION}>
  <FooterBlogRow posts={sortedPosts.slice(0, 9)} />
  <Pagination
    currentPage={1}
    totalPages={totalPages}
    nextUrl={totalPages > 1 ? "/post/1" : undefined}
  />
</BlogLayout>
