---
export const prerender = true;

import { getCollection, type CollectionEntry } from "astro:content";
import type { GetStaticPaths, Page } from "astro";
import BlogLayout from "@layouts/BlogLayout.astro";
import BlogRow from "@components/home/BlogRow.astro";
import FooterBlogRow from "@components/home/FooterBlogRow.astro";
import Pagination from "@components/blog/Pagination.astro";

export const getStaticPaths: GetStaticPaths = async ({ paginate }) => {
  const posts = await getCollection("posts");

  return paginate(posts, { pageSize: 5 });
};

type Props = {
  page: Page<CollectionEntry<"posts">>;
};

const page = Astro.props.page;
---

<BlogLayout title="Welcome to Astro.">
  <main>
    <BlogRow posts={page.data.slice(0, 2)} />
    <FooterBlogRow posts={page.data.slice(2, 5)} />
    <Pagination
      currentPage={page.currentPage}
      totalPages={Math.ceil(page.total / page.size)}
      nextUrl={page.url.next}
      prevUrl={page.url.prev}
    />
  </main>
</BlogLayout>
